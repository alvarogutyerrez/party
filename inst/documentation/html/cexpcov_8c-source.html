<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>cexpcov.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>cexpcov.c</h1><a href="cexpcov_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001                                                                    
00002 <font class="preprocessor">#include &lt;R.h&gt;</font>
00003 <font class="preprocessor">#include &lt;Rmath.h&gt;</font>
00004 <font class="preprocessor">#include &lt;Rinternals.h&gt;</font>
00005 <font class="preprocessor">#include "<a class="code" href="party_8h.html">party.h</a>"</font>
00006 
<a name="l00007"></a><a class="code" href="cexpcov_8c.html#a0">00007</a> SEXP <a class="code" href="cexpcov_8c.html#a0">kronecker</a> (SEXP A, SEXP B) {
00008 
00009     <font class="comment">/* </font>
00010 <font class="comment">    *</font>
00011 <font class="comment">    *    Kronecker Product of the </font>
00012 <font class="comment">    *    real (m x n) matrix A and the </font>
00013 <font class="comment">    *    real (r x s) matrix B</font>
00014 <font class="comment">    *</font>
00015 <font class="comment">    */</font> 
00016 
00017     <font class="comment">/*  The Kronecker product, a real (mr x ns) matrix */</font>
00018     
00019     SEXP ans; 
00020 
00021     <font class="keywordtype">int</font> i, m, j, n, k, r, l, s, mr, ns, x = 0;
00022     <font class="keywordtype">double</font> y, z;
00023 
00024     <font class="keywordflow">if</font> (!isReal(A) || !isReal(B)) 
00025         <a class="code" href="mvt_8h.html#a10">error</a>(<font class="stringliteral">"A and B are not of type REAL"</font>);
00026 
00027     <font class="keywordflow">if</font> (isMatrix(A)) {
00028         m = INTEGER(getAttrib(A, R_DimSymbol))[0];
00029         n = INTEGER(getAttrib(A, R_DimSymbol))[1];
00030     } <font class="keywordflow">else</font> {
00031         m = LENGTH(A);
00032         n = 1;
00033     }
00034     
00035     <font class="keywordflow">if</font> (isMatrix(B)) {
00036         r = INTEGER(getAttrib(B, R_DimSymbol))[0];
00037         s = INTEGER(getAttrib(B, R_DimSymbol))[1];
00038     } <font class="keywordflow">else</font> {
00039         r = LENGTH(B);
00040         s = 1;
00041     }
00042 
00043     mr = m*r;
00044     ns = n*s;
00045   
00046     PROTECT(ans = allocMatrix(REALSXP, mr, ns));
00047 
00048     <font class="keywordflow">for</font> (i = 0; i &lt; m; i++) {
00049         <font class="keywordflow">for</font> (j = 0; j &lt; n; j++) {
00050       
00051             y = REAL(A)[<a class="code" href="partycommon_8c.html#a0">aindx</a>(i, j, m)];
00052 
00053             <font class="keywordflow">for</font> (k = 0; k &lt; r; k++) {
00054                 <font class="keywordflow">for</font> (l = 0; l &lt; s; l++) {
00055                 
00056                     x = <a class="code" href="partycommon_8c.html#a0">aindx</a>(i*r + k, j*s + l, mr);
00057                     z = REAL(B)[<a class="code" href="partycommon_8c.html#a0">aindx</a>(k, l, r)];
00058                     REAL(ans)[x] = y * z;
00059                     
00060                 }
00061             }
00062         }
00063     }
00064     UNPROTECT(1);
00065     <font class="keywordflow">return</font>(ans);
00066 }  
00067 
<a name="l00068"></a><a class="code" href="cexpcov_8c.html#a1">00068</a> <font class="keywordtype">void</font> <a class="code" href="cexpcov_8c.html#a1">setAllZero</a>(SEXP A) {
00069 
00070     <font class="keywordtype">int</font> n, m, i, j;
00071     SEXP tmp;
00072     
00073     n = LENGTH(A);
00074     <font class="keywordflow">for</font> (i = 0; i &lt; n; i++) {
00075         tmp = VECTOR_ELT(A, i);
00076         m = LENGTH(tmp);
00077         <font class="keywordflow">for</font> (j = 0; j &lt; m; j++) REAL(tmp)[j] = 0.0;
00078     }
00079 }
00080 
<a name="l00081"></a><a class="code" href="cexpcov_8c.html#a2">00081</a> SEXP <a class="code" href="cexpcov_8c.html#a2">ec</a>(SEXP Weights, SEXP Scores, SEXP cweights) {
00082 
00083     <font class="comment">/*</font>
00084 <font class="comment">    *</font>
00085 <font class="comment">    *   Conditional Expectation and Covariance of </font>
00086 <font class="comment">    *   Linear Statistics of the form</font>
00087 <font class="comment">    *</font>
00088 <font class="comment">    *       L = vec(W %*% diag(cw) %*% S)</font>
00089 <font class="comment">    *</font>
00090 <font class="comment">    */</font>
00091     
00092     <font class="comment">/*  (p x nobs) matrix of weights  */</font>
00093 
00094     SEXP W;             
00095     
00096     <font class="comment">/*  (nobs x q) matrix of scores   */</font>
00097 
00098     SEXP S;
00099     
00100     <font class="comment">/*  nobs vector of case weights   */</font>
00101 
00102     SEXP cw;
00103     
00104     <font class="comment">/*  list of two return values: conditional expectation and covariance  */</font>
00105 
00106     SEXP ans, expL, covL;
00107     
00108     <font class="comment">/*  dimensions of W and S and corresponding loop variables  */</font>
00109 
00110     <font class="keywordtype">int</font> nobs, i;
00111     <font class="keywordtype">int</font> p, k;
00112     <font class="keywordtype">int</font> q, j; 
00113     <font class="keywordtype">int</font> pq;
00114     
00115     <font class="comment">/*  sum of case weights  */</font>
00116 
00117     <font class="keywordtype">double</font> scw;
00118     
00119     <font class="comment">/*  mothers little helpers  */</font>
00120 
00121     <font class="keywordtype">double</font> f1, f2;
00122     SEXP ES, VS, VT1, VT2;
00123     SEXP wi, wiT, swi, swiT, wi_k_VS, VTp, wi_k_wiT;
00124     SEXP helpers;
00125     
00126     <font class="comment">/* coerce the inputs to REALSXPs */</font>
00127     
00128     PROTECT(W  = coerceVector(Weights, REALSXP));
00129     PROTECT(S  = coerceVector(Scores, REALSXP));
00130     PROTECT(cw = coerceVector(cweights, REALSXP));
00131 
00132     <font class="comment">/* determine the dimensions and some checks */</font>
00133 
00134     nobs = INTEGER(getAttrib(W, R_DimSymbol))[1];
00135     p    = INTEGER(getAttrib(W, R_DimSymbol))[0];
00136     q    = INTEGER(getAttrib(S, R_DimSymbol))[1];
00137     pq   = p * q;
00138     
00139     <font class="keywordflow">if</font> (INTEGER(getAttrib(S, R_DimSymbol))[0] != nobs)
00140         <a class="code" href="mvt_8h.html#a10">error</a>(<font class="stringliteral">"score matrix does not have %d rows"</font>, nobs);
00141     <font class="keywordflow">if</font> (LENGTH(cw) != nobs) 
00142         <a class="code" href="mvt_8h.html#a10">error</a>(<font class="stringliteral">"vector of case weights does not have %d elements"</font>, nobs);
00143 
00144     <font class="comment">/*  compute the sum of the case weights */</font>
00145         
00146     scw = 0;
00147     <font class="keywordflow">for</font> (i = 0; i &lt; nobs; i++) scw = scw + REAL(cw)[i];
00148 
00149     <font class="comment">/*  allocate storage: the list of return values */</font>
00150 
00151     PROTECT(ans = allocVector(VECSXP, 2));
00152     SET_VECTOR_ELT(ans, 0, expL = allocVector(REALSXP, pq));
00153     SET_VECTOR_ELT(ans, 1, covL = allocMatrix(REALSXP, pq, pq));
00154 
00155     <font class="comment">/* allocate storage: all helpers */</font>
00156     
00157     PROTECT(helpers = allocVector(VECSXP, 7));
00158     SET_VECTOR_ELT(helpers, 0, ES = allocMatrix(REALSXP, 1, q));
00159     SET_VECTOR_ELT(helpers, 1, VS = allocMatrix(REALSXP, q, q));
00160     SET_VECTOR_ELT(helpers, 2, wi = allocMatrix(REALSXP, p, 1));
00161     SET_VECTOR_ELT(helpers, 3, wiT = allocMatrix(REALSXP, 1, p));
00162     SET_VECTOR_ELT(helpers, 4, swi = allocMatrix(REALSXP, p, 1));
00163     SET_VECTOR_ELT(helpers, 5, swiT = allocMatrix(REALSXP, 1, p));
00164     SET_VECTOR_ELT(helpers, 6, VTp = allocMatrix(REALSXP, p, p));
00165 
00166     <font class="comment">/* make sure the helpers are initially zero */</font>
00167 
00168     <a class="code" href="cexpcov_8c.html#a1">setAllZero</a>(helpers);
00169 
00170     <font class="comment">/* </font>
00171 <font class="comment">    *   ES:  the expectation of the scores </font>
00172 <font class="comment">    *   swi: row sums of the weights</font>
00173 <font class="comment">    */</font>
00174     
00175 
00176     <font class="keywordflow">for</font> (i = 0; i &lt; nobs; i++) {
00177 
00178         <font class="comment">/*  observations with zero case weights do not contribute */</font>
00179     
00180         <font class="keywordflow">if</font> (REAL(cw)[i] == 0.0) <font class="keywordflow">continue</font>;
00181     
00182         <font class="keywordflow">for</font> (j = 0; j &lt; q; j++) {
00183             REAL(ES)[j] = REAL(ES)[j] 
00184                           + REAL(cw)[i] * REAL(S)[<a class="code" href="partycommon_8c.html#a0">aindx</a>(i, j, nobs)];
00185         } 
00186         <font class="keywordflow">for</font> (k = 0; k &lt; p; k++) {
00187             REAL(swi)[k] = REAL(swi)[k] 
00188                            + REAL(cw)[i] * REAL(W)[<a class="code" href="partycommon_8c.html#a0">aindx</a>(k, i, p)];
00189         }
00190     }
00191 
00192     <font class="keywordflow">for</font> (j = 0; j &lt; q; j++) {
00193         REAL(ES)[j] = REAL(ES)[j] / scw;
00194     }
00195 
00196     <font class="comment">/*</font>
00197 <font class="comment">    *   expL: expectation of the linear statistic L</font>
00198 <font class="comment">    *   swiT: transpose of the row sum of the weights</font>
00199 <font class="comment">    */</font>
00200 
00201     <font class="keywordflow">for</font> (k = 0; k &lt; p; k++) {
00202         REAL(swiT)[k] = REAL(swi)[k];
00203         <font class="keywordflow">for</font> (j = 0; j &lt; q; j++) {
00204             REAL(expL)[<a class="code" href="partycommon_8c.html#a0">aindx</a>(k,j,p)] = REAL(swi)[k] * REAL(ES)[j];
00205         }
00206     }
00207 
00208     <font class="comment">/*</font>
00209 <font class="comment">    *   VS:  covariance of the scores</font>
00210 <font class="comment">    */</font> 
00211 
00212     <font class="keywordflow">for</font> (i = 0; i &lt; nobs; i++) {
00213 
00214         <font class="keywordflow">if</font> (REAL(cw)[i] == 0.0) <font class="keywordflow">continue</font>;
00215      
00216         <font class="keywordflow">for</font> (j = 0; j &lt; q; j++) {
00217             <font class="keywordflow">for</font> (k = 0; k &lt; q; k++) {
00218                 REAL(VS)[<a class="code" href="partycommon_8c.html#a0">aindx</a>(k, j, q)] = REAL(VS)[<a class="code" href="partycommon_8c.html#a0">aindx</a>(k, j, q)] + 
00219                     REAL(cw)[i] * (REAL(S)[<a class="code" href="partycommon_8c.html#a0">aindx</a>(i, k, nobs)] - REAL(ES)[k]) * 
00220                                   (REAL(S)[<a class="code" href="partycommon_8c.html#a0">aindx</a>(i, j, nobs)] - REAL(ES)[j]);
00221             }
00222         }
00223     }
00224 
00225     <font class="keywordflow">for</font> (j = 0; j &lt; q*q; j++) {
00226         REAL(VS)[j] = REAL(VS)[j] / scw;
00227     }
00228     
00229     <font class="comment">/* </font>
00230 <font class="comment">    *   covL:  covariance of the linear statistic L</font>
00231 <font class="comment">    */</font>
00232     
00233     <font class="keywordflow">for</font> (i = 0; i &lt; nobs; i++) {
00234 
00235         <font class="keywordflow">if</font> (REAL(cw)[i] == 0.0) <font class="keywordflow">continue</font>;
00236         
00237         <font class="keywordflow">for</font> (k = 0; k &lt; p; k++) {
00238             REAL(wi)[k] = REAL(W)[<a class="code" href="partycommon_8c.html#a0">aindx</a>(k, i, p)];
00239             REAL(wiT)[k] = REAL(W)[<a class="code" href="partycommon_8c.html#a0">aindx</a>(k, i, p)];
00240         } 
00241 
00242         wi_k_wiT = <a class="code" href="cexpcov_8c.html#a0">kronecker</a>(wi, wiT);
00243 
00244         <font class="keywordflow">for</font> (k = 0; k &lt; p*p; k++) {
00245             REAL(VTp)[k] = REAL(VTp)[k] + REAL(cw)[i] * REAL(wi_k_wiT)[k];
00246         }
00247     }
00248     
00249     VT1 = <a class="code" href="cexpcov_8c.html#a0">kronecker</a>(VS, VTp);
00250 
00251     wi_k_VS = <a class="code" href="cexpcov_8c.html#a0">kronecker</a>(VS, swi);
00252     VT2 = <a class="code" href="cexpcov_8c.html#a0">kronecker</a>(wi_k_VS, swiT);
00253 
00254     f1 = scw/(scw - 1);
00255     f2 = (1/(scw - 1));
00256 
00257     <font class="keywordflow">for</font> (k = 0; k &lt; (pq * pq); k++) {
00258         REAL(covL)[k] = f1 * REAL(VT1)[k] - f2 * REAL(VT2)[k];
00259     }
00260 
00261     UNPROTECT(5);
00262     <font class="keywordflow">return</font>(ans);
00263 }
00264 
00265 
<a name="l00266"></a><a class="code" href="cexpcov_8c.html#a3">00266</a> SEXP <a class="code" href="cexpcov_8c.html#a3">evS</a>(SEXP Scores, SEXP cweights) {
00267 
00268     <font class="comment">/*</font>
00269 <font class="comment">    *    expectation and variance (!) of the scores only</font>
00270 <font class="comment">    */</font>
00271 
00272 
00273     SEXP S;
00274     
00275     <font class="comment">/*  nobs vector of case weights   */</font>
00276 
00277     SEXP cw;
00278     
00279     <font class="comment">/*  list of two return values: conditional expectation and variance  */</font>
00280 
00281     SEXP ans, ES, VS, scw;
00282     
00283     <font class="comment">/*  dimensions of W and S and corresponding loop variables  */</font>
00284 
00285     <font class="keywordtype">int</font> nobs, i;
00286     <font class="keywordtype">int</font> k;
00287     <font class="keywordtype">int</font> q, j; 
00288     
00289     <font class="comment">/* coerce the inputs to REALSXPs */</font>
00290     
00291     PROTECT(S  = coerceVector(Scores, REALSXP));
00292     PROTECT(cw = coerceVector(cweights, REALSXP));
00293 
00294     <font class="comment">/* determine the dimensions and some checks */</font>
00295 
00296     nobs = INTEGER(getAttrib(S, R_DimSymbol))[0];
00297     q    = INTEGER(getAttrib(S, R_DimSymbol))[1];
00298     
00299     <font class="keywordflow">if</font> (LENGTH(cw) != nobs) 
00300         <a class="code" href="mvt_8h.html#a10">error</a>(<font class="stringliteral">"vector of case weights does not have %d elements"</font>, nobs);
00301 
00302     <font class="comment">/*  allocate storage: the list of return values */</font>
00303 
00304     PROTECT(ans = allocVector(VECSXP, 3));
00305     SET_VECTOR_ELT(ans, 0, ES = allocVector(REALSXP, q));
00306     SET_VECTOR_ELT(ans, 1, VS = allocVector(REALSXP, q));
00307     SET_VECTOR_ELT(ans, 2, scw = allocVector(REALSXP, 1));
00308     
00309     <a class="code" href="cexpcov_8c.html#a1">setAllZero</a>(ans);
00310 
00311     <font class="keywordflow">for</font> (i = 0; i &lt; nobs; i++) {
00312 
00313         <font class="keywordflow">if</font> (REAL(cw)[i] == 0.0) <font class="keywordflow">continue</font>;
00314 
00315         REAL(scw)[0] = REAL(scw)[0] + REAL(cw)[i];
00316 
00317         <font class="keywordflow">for</font> (k = 0; k &lt; q; k++) {
00318             REAL(ES)[k] = REAL(ES)[k] 
00319                           + REAL(cw)[i] * REAL(S)[<a class="code" href="partycommon_8c.html#a0">aindx</a>(i, k, nobs)];
00320         }
00321 
00322     }
00323 
00324     <font class="keywordflow">for</font> (k = 0; k &lt; q; k++) {
00325         REAL(ES)[k] = REAL(ES)[k] / REAL(scw)[0];
00326     }
00327 
00328     <font class="keywordflow">for</font> (i = 0; i &lt; nobs; i++) {
00329         
00330         <font class="keywordflow">if</font> (REAL(cw)[i] == 0.0) <font class="keywordflow">continue</font>;
00331     
00332         <font class="keywordflow">for</font> (j = 0; j &lt; q; j++) {
00333                 REAL(VS)[j] = REAL(VS)[j] + 
00334                     REAL(cw)[i] * (REAL(S)[<a class="code" href="partycommon_8c.html#a0">aindx</a>(i, j, nobs)] - REAL(ES)[j]) * 
00335                                   (REAL(S)[<a class="code" href="partycommon_8c.html#a0">aindx</a>(i, j, nobs)] - REAL(ES)[j]);
00336         }
00337     }
00338     
00339     <font class="keywordflow">for</font> (k = 0; k &lt; q; k++) {
00340         REAL(VS)[k] = REAL(VS)[k] / REAL(scw)[0];
00341     }
00342 
00343     UNPROTECT(3);
00344     <font class="keywordflow">return</font>(ans);
00345 }
00346 
00347 
<a name="l00348"></a><a class="code" href="cexpcov_8c.html#a4">00348</a> SEXP <a class="code" href="cexpcov_8c.html#a4">evL</a>(SEXP Weights, SEXP Scores, SEXP cweights, SEXP evSans) {
00349 
00350     <font class="comment">/*</font>
00351 <font class="comment">     *</font>
00352 <font class="comment">     *   Conditional Expectation and Variance of</font>
00353 <font class="comment">     *   Linear Statistics of the form</font>
00354 <font class="comment">     *</font>
00355 <font class="comment">     *       L = vec(W %*% diag(cw) %*% S)</font>
00356 <font class="comment">     *</font>
00357 <font class="comment">     */</font>
00358                                 
00359     <font class="comment">/*  (p x nobs) matrix of weights  */</font>
00360 
00361     SEXP W;     
00362     
00363     <font class="comment">/*  (nobs x q) matrix of scores   */</font>
00364 
00365     SEXP S;
00366     
00367     <font class="comment">/*  nobs vector of case weights   */</font>
00368 
00369     SEXP cw;
00370     
00371     
00372     <font class="comment">/*  list of two return values: conditional expectation and variance  */</font>
00373 
00374     SEXP ans, expL, varL;
00375     
00376     <font class="comment">/*  dimensions of W and S and corresponding loop variables  */</font>
00377 
00378     <font class="keywordtype">int</font> nobs, i;
00379     <font class="keywordtype">int</font> p, k;
00380     <font class="keywordtype">int</font> q, j; 
00381     <font class="keywordtype">int</font> pq;
00382     
00383     <font class="keywordtype">double</font> scw;
00384     
00385     <font class="comment">/*  mothers little helpers  */</font>
00386 
00387     <font class="keywordtype">double</font> f1, f2;
00388     SEXP helpers, ES, VS, wi, wii;
00389     
00390     <font class="comment">/* coerce the inputs to REALSXPs */</font>
00391     
00392     PROTECT(W  = coerceVector(Weights, REALSXP));
00393     PROTECT(S  = coerceVector(Scores, REALSXP));
00394     PROTECT(cw = coerceVector(cweights, REALSXP));
00395 
00396     <font class="comment">/* determine the dimensions and some checks */</font>
00397 
00398     nobs = INTEGER(getAttrib(W, R_DimSymbol))[1];
00399     p    = INTEGER(getAttrib(W, R_DimSymbol))[0];
00400     q    = INTEGER(getAttrib(S, R_DimSymbol))[1];
00401     pq   = p * q;
00402     
00403     <font class="keywordflow">if</font> (INTEGER(getAttrib(S, R_DimSymbol))[0] != nobs)
00404         <a class="code" href="mvt_8h.html#a10">error</a>(<font class="stringliteral">"score matrix does not have %d rows"</font>, nobs);
00405     <font class="keywordflow">if</font> (LENGTH(cw) != nobs) 
00406         <a class="code" href="mvt_8h.html#a10">error</a>(<font class="stringliteral">"vector of case weights does not have %d elements"</font>, nobs);
00407 
00408     <font class="comment">/*  compute the sum of the case weights */</font>
00409         
00410     scw = REAL(VECTOR_ELT(evSans, 2))[0];
00411     ES = VECTOR_ELT(evSans, 0);
00412     VS = VECTOR_ELT(evSans, 1);
00413     
00414     <font class="comment">/*  allocate storage: the list of return values */</font>
00415 
00416     PROTECT(ans = allocVector(VECSXP, 2));
00417     SET_VECTOR_ELT(ans, 0, expL = allocVector(REALSXP, pq));
00418     SET_VECTOR_ELT(ans, 1, varL = allocVector(REALSXP, pq));
00419     
00420     PROTECT(helpers = allocVector(VECSXP, 2));
00421     SET_VECTOR_ELT(helpers, 0, wi = allocVector(REALSXP, p));
00422     SET_VECTOR_ELT(helpers, 1, wii = allocVector(REALSXP, p));
00423 
00424     <a class="code" href="cexpcov_8c.html#a1">setAllZero</a>(helpers);
00425 
00426     <font class="keywordflow">for</font> (i = 0; i &lt; nobs; i++) {
00427 
00428         <font class="keywordflow">if</font> (REAL(cw)[i] == 0.0) <font class="keywordflow">continue</font>;
00429 
00430         <font class="keywordflow">for</font> (k = 0; k &lt; p; k++) {
00431             REAL(wi)[k] = REAL(wi)[k] 
00432                           + REAL(cw)[i] * REAL(W)[<a class="code" href="partycommon_8c.html#a0">aindx</a>(k, i, p)];
00433         }
00434 
00435         <font class="keywordflow">for</font> (k = 0; k &lt; p; k++) {
00436             REAL(wii)[k] = REAL(wii)[k] 
00437                          + REAL(cw)[i] * REAL(W)[<a class="code" href="partycommon_8c.html#a0">aindx</a>(k, i, p)] 
00438                            * REAL(W)[<a class="code" href="partycommon_8c.html#a0">aindx</a>(k, i, p)];
00439         }
00440     }
00441 
00442     f1 = scw/(scw - 1);
00443     f2 = (1/(scw - 1));
00444     <font class="keywordflow">for</font> (k = 0; k &lt; p; k++) {
00445         <font class="keywordflow">for</font> (j = 0; j &lt; q; j++) {
00446             REAL(expL)[j*p + k] = REAL(ES)[j] * REAL(wi)[k];
00447             REAL(varL)[j*p + k] = f1*REAL(VS)[j] * REAL(wii)[k] 
00448                                 - f2*REAL(VS)[j] * REAL(wi)[k]*REAL(wi)[k];
00449         }
00450     }
00451     UNPROTECT(5);
00452     <font class="keywordflow">return</font>(ans);
00453 }
00454 
<a name="l00455"></a><a class="code" href="cexpcov_8c.html#a5">00455</a> SEXP <a class="code" href="cexpcov_8c.html#a5">ev</a>(SEXP Weights, SEXP Scores, SEXP cweights) {
00456 
00457     <font class="comment">/*</font>
00458 <font class="comment">     *</font>
00459 <font class="comment">     *   Conditional Expectation and Variance of</font>
00460 <font class="comment">     *   Linear Statistics of the form</font>
00461 <font class="comment">     *</font>
00462 <font class="comment">     *       L = vec(W %*% diag(cw) %*% S)</font>
00463 <font class="comment">     *</font>
00464 <font class="comment">     */</font>
00465                                 
00466 
00467     SEXP evSans, ans;
00468     
00469     evSans = <a class="code" href="cexpcov_8c.html#a3">evS</a>(Scores, cweights);
00470     ans = <a class="code" href="cexpcov_8c.html#a4">evL</a>(Weights, Scores, cweights, evSans);
00471     <font class="keywordflow">return</font>(ans);
00472 
00473 }
</pre></div><hr><address align="right"><small>Generated on Thu Apr 14 11:34:01 2005 for party by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
